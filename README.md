## MHGNet: Multi-Heterogeneous Graph Neural Network for Traffic Prediction
![model (2)](https://github.com/user-attachments/assets/3be9fd69-4b9f-4fec-a161-f93dcb8cffbb)
### Abstract
In recent years, traffic flow prediction has become essential for managing intelligent transportation systems. Traditional forecasting methods often oversimplify non-Euclidean low-dimensional traffic data by representing it as a basic graph with uniform nodes and edges, failing to capture similar trends among nodes of the same type. This paper introduces MHGNet, a novel framework that models spatiotemporal multi-heterogeneous graphs. The framework includes an STD Module that transforms single-pattern traffic data into multi-pattern data using feature mappings of timestamp and node embedding matrices. Additionally, a Node Clusterer employs Euclidean distance for efficient O(N) time complexity clustering of nodes based on different types. Within these clusters, nodes undergo residual subgraph convolution in spatiotemporal fusion subgraphs generated by the DSTGG Module, followed by node repositioning and weight redistribution in the SIE Module. A series of ablation and quantitative evaluations on four widely used benchmarks demonstrate the effectiveness of MHGNet.
### Dataset 
Processed datasets METR-LA\PEMS-BAY\PEMS04\PEMS08: [GoogleDrive](https://drive.google.com/file/d/1X__Vrl_FRCVH9iemE9_0Y6vUexhEMXLa/view?usp=drive_link)

Original dataset and processing code: [GoogleDrive](https://drive.google.com/file/d/1gPhycJQ39YVTjRwqJE5INtQYn8-fqPXD/view?usp=drive_link)

Please put the processed dataset in the datasets directory.
### RUN
```
conda create -n MHGNet python==3.8
conda activate MHGNet
pip install -r requirement.txt
cd MHGNet
python train.py
```
### WEIGHTS
The saved trained weights: 

If you want to test, place the trained weights in the output folder, change the [start_up][mode] parameter in the configs to "resume," and then run python train.py.
